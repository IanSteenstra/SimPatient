using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Xml;
using Jint.Native;
using Newtonsoft.Json;
using UnityEngine;
using UnityEngine.Networking;


public class GenerateSessionSummaryResponse : MonoBehaviour
{

    [Serializable]
    private class SessionSummaryResponse
    {
        public string id;
        [JsonProperty("object")]
        public string created;
        public string model;
        public string system_fingerprint;
        public List<SessionSummaryChoice> choices;
        public Usage usage;
    }

    [Serializable]
    private class SessionSummaryChoice
    {
        public int index;
        public Message message;
        public object logprobs;
        public string finish_reason;
    }

    [Serializable]
    private class Message
    {
        public string role;
        public string content;
    }

    [Serializable]
    private class Usage
    {
        public int prompt_tokens;
        public int completion_tokens;
        public int total_tokens;
    }

    [Serializable]
    private class RequestData
    {
        public string model;
        public int max_tokens;
        public int temperature;
        public List<ChatMessage> messages = new List<ChatMessage>();
    }

    [Serializable]
    private class ChatMessage
    {
        public string role;
        public string content;
    }

    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.BeforeSceneLoad)]
    private static void Initialize()
    {
        var generateSessionSummaryResponse = new GameObject("GenerateSessionSummaryResponse").AddComponent<GenerateSessionSummaryResponse>();
        Globals.Register(generateSessionSummaryResponse);
    }

    public void StartSessionSummaryResponseCoroutine(Delegate callback)
    {
        Debug.Log("StartSessionSummaryResponseCoroutine");
        StartCoroutine(SessionSummaryResponseAsync(callback));
    }

    private IEnumerator SessionSummaryResponseAsync(Delegate callback)
    {
        string mitiManual = @"MotivationalInterviewingTreatmentIntegrityCodingManual4.2.1 T.B. �Moyers1, �J.K. �Manuel2,&D.Ernst3 University �of �New �Mexico 1CenteronAlcoholism,SubstanceAbuse,andAddictions(CASAA) 2DepartmentofVeteransAffairs 3Denise �ErnstTraining& �Consultation Recommendedcitation: Moyers, �T.B., �Manuel, �J.K., �&Ernst, �D.(2014). �Motivational Interviewing Treatment Integrity �Coding Manual 4.1.Unpublishedmanual. We �are �grateful �tothefollowingeditorsofthismanual: LisaHagenGlynn ChristianaFortini Revisions �for4.1 TextchangeinPersuadewithPermissiontoclarifythelengthandextentofpermissionCorrectionofformattingerrorsRevisionofexamples Revisions �for4.2 A. SustainTalk AddedsentencetoSofteningSustainTalkglobalindicatingthattherapistsmayreceivehigh scores �on �this �scale �even �if �no �sustain �talk �is �present �in �the �session. AlsoaddedthispointasFAQ # �6. AddedFAQtoelaborateonuseofsustaintalktobuildempathyandhowthismightbereflectedinscoringforSofteningSustainTalk(FAQ#7) AddedFAQtoelaborateonhowSofteningSustainTalkshouldbescoredindecisional �balance �exercise(FAQ#8) B. � �Change �Talk AddedsentencetoCultivatingChangeTalkindicatingthatclinicians �should �not �be �penalizedif clients �do �not �offer �change �talk �despite �their �efforts. � � C. SeekingCollaboration Addedsentencetoindicate �thatSeek �Collaboration �code �need �not �be �assigned �when �therapists �arequeryingclient�sintellectualgraspoftheirstatements(FAQ#9) A. �INTRODUCTION TO THE �MITI Purpose of the MITI Howwellorpoorlyisaclinicianusingmotivationalinterviewing? �The �MITI �is �a �behavioral codingsystem �thatprovidesananswertothisquestion. �The �MITI �also �yields �feedback �that �can �beusedtoincreaseclinicalskillinthepracticeofmotivationalinterviewing. �The �MITI �is �intended �to �be �usedasa: 1)Treatmentintegritymeasureforclinicaltrialsofmotivationalinterviewing. 2)Means �ofprovidingstructured,formalfeedbackaboutwaystoimprovepracticeinnon.research �settings. � 3)Componentofselectioncriteriafortrainingandhiring(formoreinformationaboutthis,seetheFAQsectioninAppendix �B; �in �progress). TheMITIevaluatescomponentprocesseswithinmotivationalinterviewing, �including �engaging,focusing,evoking,and �planning. �Sessions �without �a �specific �change �target �orgoalmaynotbe �appropriate �for �evaluation �with �the �MITI �(see �Designating �a �Change �Goal; �Section �C), �althoughsomeoftheelementsmaybeusefulforevaluatingandgivingfeedback �about �engaging �skills. B. COMPONENTS �OF �THE �MITI TheMITIhastwocomponents:theglobal �scores �and �the �behaviorcounts. Aglobalscorerequiresthecodertoassignasinglenumberfrom �afive-..point �scale �to �characterize �anentire �interaction. �Thesescoresaremeanttocapturetherater�sglobal impressionoroveralljudgmentaboutthedimension,sometimescalledthe�gestalt�. �Four �globaldimensionsarerated: �Cultivating �Change �Talk, �Softening �Sustain �Talk,Partnership, �andEmpathy. �ThismeansthateachMITIreviewwillcontainfour �global �scores. Abehaviorcountrequiresthecoder �to �tally �instances �of �particular �interviewer �behaviors. �These �runningtalliesoccurfrom �thebeginningofthesegmentbeingrevieweduntiltheend. �The �coder �is �not �required �to �judge �the �overall �qualityoftheevent,aswithglobalscores,butsimplytocount �each �instance �of �the �behavior. � Typically, �both �the �global �scoresandbehaviorcounts �are �assessed �within �a �single �review �of �the �audio �recording. �Arandom �20-..minutesegmentis �therecommendedduration �for �a �coding �sample. �Shorterorlongersegmentsmaybeused,but �caution �is �warranted �in �assigning �and �interpretingglobalscoresforlongerorshortersamples. �Carefulattention �should �be �paid �to �ensurethatthesamplingofthesegmentsistrulyrandom,especiallywithinclinical �trials, �so �that proper �inferences �about �the �overall �integrity �of �the �MI �intervention �can �be �drawn. � Therecordingmaybestoppedasneeded,but �excessive �stopping �and �restarting �during �actual �coding(asopposedtotrainingorgroupreview)maydisrupttheabilityofthecodertoform �a gestaltimpressionneededfortheglobalcodes. �Codersmaythereforedecidetousetwopasses through �the �recording �until �they �are �proficient �in �using �the �coding �system. �In �that �case, �the �first �pass �should �be �used �for �the �global �scores �and �the �second �for �the �behavior �counts. C. DESIGNATING A �CHANGE GOAL � � AnimportantfeatureoftheMITIinvolvesfocusingonaparticularchangegoalandmaintainingaspecific �direction �about �that �change �within �the �conversation. �Change �goals,sometimescalledtargetbehaviors,maybeveryspecificandbehavioral(e.g.,reducingdrinking,monitoringbloodsugar,engaginginatreatmentprogram). �Coders must be �told prior to coding what the �designated change �goal is for the �interaction. �Thisshouldbedesignatedonthecodingform �bythecoder,beforecodingbegins.Thiswillallowcoderstojudgemoreaccuratelywhethertheclinicianisdirectinginterventionstowardthechangegoalandevokingcontentfrom �theclientaboutit. D. GLOBAL �SCORES Globalscoresareintendedtocapturetherater�soverallimpressionofhowwellorpoorlytheclinicianmeetsthedescriptionofthedimensionbeingmeasured. �Althoughthismaybeaccomplishedbysimultaneouslyevaluatingmanysmallelements, �the �rater�s �all-..at-..once �judgmentisparamount. �The �global �scores �should �reflect �the �holistic �evaluation �of �the �interviewer, �whichcannotnecessarilybeseparatedintoindividualelements. � Global �scores �are �assignedon �a �five-..point �Likert �scale, �withaminimum �of�1�andamaximum �of �5.� �Thecoder �assumesa �defaultscore �of�3�and �movesup �or �down �as �indicated. �A�3�mayalso reflectmixedpractice. �A�5�isgenerallynotgivenwhenthereareprominentexamplesofpoor practiceinthesegment. Cultivating Change Talk Low  High 1  2  3  4  5 Clinicianshowsno � Cliniciansporadically  Clinicianoften  Clinician  Clinicianshowsa � explicitattentionto,  attendsto �client  attendsto �theclient�s  consistentlyattends � markedand orpreferencefor, languageinfavorof � languageinfavorof � totheclient�s  consistenteffortto theclient�slanguage change� �frequently change,butmisses � languageabout increase �the �depth, infavorof �changing  missesopportunitiestoencouragechange someopportunitiestoencouragechange changeandmakes �effortstoencourage � strength,or momentum �ofthe talk  talk  it  client�slanguagein favorof �change Thisscaleisintendedtomeasuretheextenttowhichtheclinicianactivelyencouragestheclient�s �own �language �in �favor �ofthechange �goal,andconfidenceformakingthatchange.To achieve �higher �ratings �on �theCultivatingChange �Talkscale, �the �change �goalmustbeobviousinthesessionandtheconversationmustbelargelyfocusedonchange, �with �the �clinician �activelycultivating �change �talkwhen �possible. � � �Low �scores �on �this �scale �occur �when �the �clinician �is inattentive �to �the �client�s �language �about �change, �either �by �failing �to �recognize �and �follow �up �on �it, �or �by �prioritizing �other �aspects �of �the �interaction �(such �as �history-..taking,assessmentornon.directivelistening).InteractionslowinCultivatingChangeTalkmaystillbehighlyempathicandclinically �appropriate. Care �should �be �takennotto �penalize �clinicians �ifclients �donotoffer �change �talkor �donot respond �to �efforts �to �evoke �it. Verbal Anchors 1.Clinicianshows �no �explicitattentionto,or �preference �for,the �client�slanguage �infavor �of �changing. Examples: � Asksonlyforahistoryoftheproblem � Structurestheconversationtofocusonlyontheproblemstheclientisexperiencing � Showsno �interest �orconcern �for �client �values, �strengths, �hopes �or �pastsuccesses � Provides �education �as �only �interaction �with �the �client � Suppliesreasonsforchangeratherthanencouragingthem �from �theclient � Ignores �change �talk �when �it �is �offered 2.Cliniciansporadically �attends �to �clientlanguage �infavor �ofchange ��frequentlymisses opportunities �to �encourage �change �talk. Examples: � Superficial �attention �to �client �language �about �thechange �goal � Fails �to �askaboutpotentialbenefits �ofchange � Lackofcuriosityorminimalinterestinclient�svalues, �strengths �and �pastsuccesses 3.Clinicianoftenattendstotheclient�slanguageinfavorofchange,butmissessome opportunities �to �encourage �change �talk. Examples: � Misses �opportunitiesto �encourage �client �language �in �favorofchange � � � Maygiveequaltimeandattentiontosustaintalkandchangetalk,forexampleusingdecisionalbalanceaftermomentum �forchangeisemerging 4.Clinicianconsistently �attends �to �the �client�slanguage �aboutchange �andmakeseffortsto encourage �it. Examples: � More �often �than �not, �acknowledges �client �reasons �for �change �and �explores �when �they �are offered � Often �responds �to �change �talkwith �reflections �that �do �not �encourage �deeper �exploration �from �theclient � Expressescuriosity �when �clients �offer �change �talk � Mayexplore �client�s �values, �strengths, �hopes �and �past �successes �related �to �target �goal 5. �Clinician �showsamarked and consistent �effort �to �increase �the �depth,strength,ormomentum �of �the �client�slanguage �infavor �of �change. � Examples: � Over �a �series �of �exchanges, �the �clinician �shapes �the �client�slanguage �in �favor �of �change � Uses �structured �therapeutic �tasks �as �a �way �of �eliciting �and �reinforcing �change �talk � Doesnotusuallymissopportunitiestoexploremoredeeply �when �clientoffers �changetalk � � Strategically �elicits �change �talk �and �consistently �responds �to �it �when �offered � Rarelymissesopportunitiestobuildmomentum �ofchangetalk Softening �Sustain �Talk Low  High 1  2  3  4  5 Clinicianconsistently Clinicianusually Cliniciangives Cliniciantypically Clinicianshowsa � responds �to �the  chooses �toexplore,  preferencetothe avoidsanemphasis markedand client�slanguageina focuson, �orrespond client�slanguagein onclientlanguage consistenteffortto mannerthat  totheclient�s  favorof �thestatus  favoringthestatus  decreasethedepth, facilitatesthe  languageinfavorof � quo,butmayshow quo.  strength, �or frequencyordepthof � thestatusquo.  someinstances �of  momentum �ofthe argumentsinfavorof shiftingthefocus � clients �languagein thestatusquo.  away �fromsustain  favorof �thestatus talk.  quo. Thisscaleisintendedtomeasuretheextentthattheclinicianavoidsafocusonthereasons againstchangingorformaintainingthestatus �quo. �To �achieve �high �scores,clinicians �should �avoidlingering �in �discussions �concerning �the �difficulty �orundesirabilityof �change. �Althoughtherapistswillsometimeschoosetoattendtosustaintalktobuildrapport,ingeneraltheyshould �spend �only �asmuchtimeasneededtobringthediscussionintomorefavorableterritoryforbuildingmotivation. �Highscoresmayalsobeachievedintheabsence �of �sustain �talk �during �a session,ifthe �clinician �doesnotengage �inbehaviors �to �evoke �it. �Lowscores �in �Softening �Sustain �Talkare �appropriate �when �clinicians �focus �considerable �attention �tothe �barriersof �change,even �when �using �MI-..consistenttechniques(e.g., �askingopenquestions,offersreflections,affirmations and �otherMIAdherenttechniques)to �evoke �and �reflect �sustain �talk �throughout �the �session. � 1. �Clinician �consistentlyrespondstotheclient�slanguageinamannerthatfacilitatesthefrequencyordepthofargumentsinfavorofthestatusquo. Examples: � Explicitlyasksforargumentsagainst �change, �queries �difficulties � Activelyseeks �elaboration �when �sustain �talkis �offeredthrough �questions, �reflections,or affirmations � Preferentialattention �andreinforcementof �sustain �talk �when �it �occursalongsidechange �talk � Sustainedcuriosity �and �focus �aboutreasons �notchange 2. �Usually �chooses �to �explore, �focus �on, �orrespond �to �client�sreasonstomaintainthestatusquo. Examples: � Often �deepens �discussion �ofbarriersor �difficulties �ofchangewhenclientmentionsthem � Asksaboutbarrierstochangeonmorethanoneoccasionduringtheinterview,eveniftheclient �does �not �bring �up � Often �reflects �benefits �of �the �statusquo 3. �Cliniciangivespreferencetotheclient�slanguageinfavorofthestatusquo,butmayshowsomeinstancesofshiftingthefocusawayfrom �sustaintalk. Examples: � Somemissedopportunitiestoshiftfocusawayfrom �sustaintalk � Attendsto �benefits �of �status �quo �even �when �client �offers �changetalk 4. �Cliniciantypicallyavoidsanemphasisonclientlanguage �favoring �the �status �quo. Examples: � Doesnot �explicitly �ask �for �reasons �not �to �change � Minimalattention �to �sustain �talk �when �it �occurs � Doesnot �seek �elaboration �of �sustain �talk � Lackofcuriosityandfocusonclient�sreasonstomaintainthestatusquo � Doesnot �linger �in �discussions �about �barriers �to �change 5. �Clinicianshows �amarked and consistent �effort �to �decrease �the �depth, �strength,ormomentum �of �the �client�slanguage �infavor �ofthe �status �quo. Examples: � uses �structured �therapeutic �task(s) �to �shift �the �focusof �sustain �talk �toward �the �target �change �goal � mayusedouble-..sidedreflections(endingwithareflectionofchangetalk)tomovetheconversationawayfrom �sustaintalk Partnership Low  High 1  2  3  4  5 Clinicianactively Clinician  Clinician  Clinicianfosters  Clinicianactively assumestheexpert  superficially  incorporates collaborationand  fostersand rolefor �the  responds �to  client�s � powersharingso encourages majorityofthe opportunities �to  contributions �but  that �client�s  powersharingin � interactionwith theclient.  collaborate.  doesso �ina lukewarmor � contributions impactthe theinteractionin suchawaythat Collaborationor  erraticfashion. � sessioninways � client�s � partnership �is  that �they contributions � absent.  otherwisewould � substantially not.  influencethe natureofthe session. Thisscaleisintendedtomeasuretheextenttowhichtheclinicianconveysanunderstandingthatexpertiseandwisdom �aboutchangeresidemostlywithintheclient. �Clinicians �high �onthis �scale �behaveas �if �the �interview �is �occurring �between �two �equal �partners,bothofwhom �have knowledgethatmightbeusefulinsolvingthechangeunderconsideration. � �Clinicians �lowon �the �scaleassumetheexpertroleforamajorityoftheinteractionandhaveahighdegreeofinfluencein �the �nature �of �the �interaction. � Verbal Anchors 1. �Clinicianactivelyassumestheexpertroleforthemajorityoftheinteractionwiththeclient. �Collaborationor �partnership �is �absent. Examples: � Explicitlytakestheexpertrolebydefiningtheproblem,prescribingthegoals,orlayingout �the �plan �of �action � Clinicianactivelyforcesaparticularagendaforthemajorityoftheinteractionwiththeclient � Deniesorminimizesclientideas � Dominatesconversation � Argueswhenclientoffersalternativeapproach � Often �exhibits �the �righting �reflex 2. �Cliniciansuperficially �responds �to �opportunitiesto �collaborate. Examples: � Clinicianrarely �surrenders �the �expert �role � � Minimalorsuperficial �querying �of �client �input � Oftensacrificesopportunitiesformutualproblem �solvinginfavorofsupplyingknowledge or �expertise � � Minimalor �superficialresponsestoclient�spotentialagendaitems,knowledge,idea,and /or �concerns � Occasionallymaycorrect �the �client �or �refutes �what �the �client �has �said 3. �Clinicianincorporates �client�scontributionsbutdoessoinalukewarm �orerraticfashion. � Examples: � Maytake �advantage �of �opportunitiesto �collaborate, �but �does �not �structure �interaction �to solicitthis � Missessomeopportunities �to �collaborate �when �initiated �by �the �client � The �righting �reflex �is �largely �absent � Sacrificessomeopportunitiesformutualproblem �solvinginfavorofsupplyingknowledge or �advice � Seemstobeinastand-..off �with �the �client; �not �wrestling �and �notdancing 4. �Clinicianfosters �collaborationand �power �sharingso �thatclient�scontributionsimpactthe sessioninways �thatthey �otherwise �would �not. Examples: � Somestructuringofsessiontoensureclientinput � Searches �foragreementonproblem �definition, �agendasetting, �and �goalsetting � Solicits �client �viewsinmorethana �perfunctory �fashion � Engagesclientinproblem �solvingorbrainstorming � Doesnotattempttoeducateordirectifclient�pushes �back� �with �sustain �talk � Doesnotinsistonresolution �unless �client �is �ready 5. �Clinicianactively �fosters �and �encourages �power �sharinginthe �interactioninsuch �away �that client�s �contributions �substantially �influence �the �nature �ofthe �session. Examples: � Genuinely �negotiates �the �agenda �and �goals �forthe �session � Indicatescuriosity �about �client �ideas �through �querying �and �listening � Facilitates �clientevaluationof �options �and �planning � Explicitly �identifiesclientastheexpertanddecisionmaker � Tempersadvicegivingandexpertisedependingonclient �input � Clinicianfavors �discussionof �client�sstrengths �and �resources �rather �than �probing �for �deficits Empathy Low  High 1  2  3  4  5 Cliniciangiveslittle  Clinicianmakes  Clinicianisactively Clinicianmakes  Clinicianshows orno �attentionto �theclient�s  sporadic �efforts �to explore �the �client�s  tryingtounderstandthe  activeandrepeatedeffortstounderstand  evidence �ofdeepunderstandingof perspective. � perspective. � client�sperspective, theclient�spoint �of  client�spointofview, Clinician�s  withmodest  view.Showsevidence � notjustforwhathas understandingmay success.  ofaccurate  been �explicitlystated beinaccurateormay understandingofthe butwhattheclient detractfromthe  client�sworldview, meansbuthasnot client�struemeaning.  althoughmostly �limitedtoexplicit  yetsaid. content. Thisscalemeasurestheextenttowhichtheclinicianunderstandsormakesanefforttograsptheclient�s �perspective �andexperience(i.e.,howmuchtheclinicianattemptsto�try �on� �what �the client �feels �or �thinks).Empathyshouldnotbeconfusedwithsympathy,warmth,acceptance, genuineness,support,or �client �advocacy; �these �are �independent �of �the �Empathyrating. Reflectivelisteningisanimportantpartofthischaracteristic, �butthis �globalrating �isintended �to �capture �all efforts thattheclinicianmakestounderstandtheclient�sperspectiveandconveythat understanding �to �the �client. ClinicianshighontheEmpathyscaleshowevidenceofunderstandingtheclient�sworldview �in �a �varietyofwaysincludingcomplexreflectionsthatseem �toanticipatewhatclientsmeanbuthave not �said, �insightful �questions �based �on �previous �listening �and �accurate �appreciation �forthe �client�semotional �state. � �Clinicians �lowon �the �Empathy �scale �donotappear �interested �inthe client�s �viewpoint. Verbal Anchors 1. �Cliniciangives �little �or �no �attention �to �the �client�s �perspective. � Examples: � Askingonlyinformation-..seeking �questions � Probingforfactualinformationwithnoattempttounderstand �the �client�s �perspective 2. �Clinicianmakessporadiceffortstoexploretheclient�sperspective. �Clinician�sunderstanding �maybeinaccurateormaydetractfrom �theclient�struemeaning. Examples: � Offers �reflections �butthey �often �misinterpret �what �the �client �had �said � Displaysshallowattemptstounderstandtheclient 3. �Clinicianisactivelytryingtounderstandtheclient�sperspective,withmodestsuccess. Examples: � May �offer �a �few �accurate �reflections, �butmaymisstheclient�spoint � Makesanattempttograsptheclient�smeaningthroughoutthesession 4. �Clinicianmakesactiveandrepeatedeffortstounderstandtheclient�spointofview.Shows �evidence �of �accurate �understanding �oftheclient�s �worldview, �althoughmostlylimitedto �explicit �content. Examples: � Conveys �interest �in �the �client�s �perspective �or �situation � Offers �accurate �reflections �ofwhatthe �client has said already � Effectivelycommunicatesunderstanding �ofthe �client�sviewpoint � Expresses �that �the �client�s �concernsorexperiencesarenormalorsimilartoothers� 5. �Clinicianshows �evidence �ofdeepunderstandingof �client�spointof �view,notjustfor �whathas �beenexplicitlystatedbutwhattheclientmeansandhasnotsaid. Examples: � Effectivelycommunicatesanunderstandingoftheclientbeyond what �the �client �says �in �session � Showsgreat �interest �in �client�s �perspective �orsituation � Attemptsto ��put �self �in �client�s �shoes� � Often �encourages �client �to �elaborate, �beyond �what �is �necessarytomerelyfollowthestory � Usesmanyaccuratecomplexreflections E. �BEHAVIOR COUNTS Behavior �counts �are �intendedto �capture �specific �behaviors �without �regardto �how �they �fit �into theoverallimpressionoftheclinician�suseofMI. �Unlike �global �ratings, �behavior �counts �will generallybedeterminedasaresultofcategorizationanddecisionrules,ratherthanattemptingtograspanoverallimpression. �Codersshould �avoid �relying �oninferencetodetermineabehavior countwhenever �possible. E.1. �Parsing �Interviewer Speech.The �session �segment �can �be �broken �down �into �volleys,which aredefined �as �uninterruptedsegments �ofclinician �speech.A �volleybeginswhentheclincian begins �speaking �andisterminatedbyclientspeech �(other �than �facilitive �commentssuchas �yeah, �right, �good�). �It �is �the �equivalent �of �turn-..taking �in �a �conversation. � E.1.a. Parsing �Rules.Clinicianvolleysarecomprisedofasingleormultipleclinician �utterances. �Anutteranceisdefinedasacompletethoughtorathoughtunit(Gottman,Markman,& �Notarius, �1977; �Weiss, �Hops, �&Patterson, �1973).Behavior �codes �are �assignedtoclinician �utterances, �although �not �allutteranceswill �receive �a �behavior �code �(see �F.StatementsthatAreNotCodedin the �MITI). � Each �utterancemayreceiveonlyonebehaviorcode �and �each �volley �earns �each �code �only �once. �Forexample,�You �are �worried �about �your �drinking� �isan �utterance �that �isassignedone �code. �Whereas, ��You �are �worried �about �your �drinking; �hasthisbeenaproblem �before?�isparsedinto �two �utterances, �that �eachreceive �a �separate �code. �Thus, �in �the �course �of �a �relatively �long �reply, �if �a �clinician �reflects, �confronts, �givesinformation, �then �asks �a �question, �these �could �each �qualify �for a �distinct �behavior �code. �Similarly,if �a �clinician �offersEmphasizingAutonomyand �anAffirm �in �thesamevolley,bothcodeswouldbegiven. �(**Note �thatthis �parsing �rule �forMI-..Adherentand MINon-..Adherentutterancesis �different �than �previous �versions �of �the �MITI). � Reflections �are �handleddifferently. �There �is �only �one �reflection �code �given �per �volley, �regardless �ofthecombinationofsimpleandcomplexreflectionsinthatvolley. �If �any �of �the �reflections �are �complex,thentheComplexReflection �(CR) �code �is �used. �Otherwise, �the �reflection �code �is �Simple Reflection �(SR).Forinstance,ifaclinicianoffersasimplereflection,asksaclosedquestion,andthenoffersacomplexreflection,thevolleywouldreceivetwocodes:complexreflectionandquestion. � Finally,for �questions, �only �oneper �volley �is �coded �with �the �MITI �4.0. �Ifmultiplequestionsareofferedwithinthesamevolley,theclinicianwillonlyreceiveasingleQuestion �behavior �code. Themaximum �possible �numberofcodespervolleyis8. �Only �one �of �each �of �the �following �codes maybeassignedpervolley: GivingInformation(GI) Persuade �(Persuadeor �Persuade �with) Question(Q) ReflectionSimple(SR)orComplex �(CR) Affirm(AF) Seeking �Collaboration �(Seek) EmphasizingAutonomy(Emphasize) Confront(Confront) DECISION RULE:If �the �coderisnotsure �whether �to �parse �ornot, �the �defaultshould �be �to �decide �in �favor �offewer parses. E.2. �Parsing �Examples: E.2.a. �Considerthefollowinginterviewerstatement: Well,letmeaskyouthis:sinceyou�vebeenforcedtocomehereandsinceyou�refeeling like �everyone�s �kind �of �pecking �on �you �like �a �crow�there�s �a �bunch �of �crows �flying �around �pecking �on �you �about �this �thing �about �your �drinking�what �would �you �liketo �do withthetimeyouspendhere? �What �wouldbe �helpful �for �you? Thisstatementisparsedinthefollowingway: Utterance �One: Well,letmeaskyouthis:sinceyou�vebeenforcedtocomehereandsince you�re �feeling �like �everyone�s �kind �of �pecking �on �you �like �a �crow�there�sabunch �of crows �flying �around �pecking �on �you �about �this �thing �with �your �drinking�(Complex Reflection) Utterance �Two:Whatwouldyouliketodowiththetimeyouspendhere? �What �wouldbe helpful �for �you? �(Seek) E.2.b. � �What �about �this �interviewerstatement? What �you �say �is �absolutely �true, �that �it �is �up �to �you. �Noonemakesthatchoiceforyou.Evenifyourwifewantedtodecideforyou,oryouremployerwantedtodecideforyou,orI �wanted �to �decide �foryou; �nobody �can. �Itreallyiscompletelyyour �own �choice�howyoulive �your �life, �what �you �do �about �drugs, �where �you�re �headed�so �thatis �yours. �AndwhatI hear �you �struggling �with �is, ��what �do �I �want? �Isittimeformetochangethings?Isthis drug �testawake-..up �call?� We�ve �parsed �it �like �this: Utterance �One: �What �you �say �is �absolutely �true, �that �it �is �up �to �you. �Noonemakesthat choiceforyou.Evenifyourwifewantedtodecideforyou,oryouremployerwantedtodecideforyou, �orIwanted �to �decideforyou; �nobody �can. �Itreallyiscompletely �your �own �choice�how �you �live �your �life, �what �you �do �about �drugs, �where �you�re �headed�so �thatis �yours. �(EmphasizingAutonomy) Utterance �Two:AndwhatIhearyoustrugglingwithis,�whatdoIwant? �Isittimeforme to �change �things? �Is �this �drug �test �a �wake-..up �call?�(ComplexReflection) E.2.c. �Whataboutthisinterviewerstatement? 15 To �answer �your �question,itisrecommendedthatpeopleeatatleast5servingsoffruit and �vegetables �each �day. �Ofcourse,youaretheonlyonewhocandeterminewhat �works foryouinthisregard.Howmanymoreadaywouldthatbe?Imean,canyoudoit? We�ve �parsed �it �like �this: UtteranceOne:Toansweryourquestion,itisrecommendedthatpeopleeatatleast5servingsoffruitand �vegetables �each �day. �(Giving �Information) UtteranceTwo:Ofcourse,youaretheonlyonewhocandeterminewhatworksforyouin this �regard. �(EmphasizingAutonomy) UtteranceThree: Howmanymoreadaywouldthatbe?Imean,canyoudoit?(Question) E.2.d. �What �about �thisinterviewerstatement? You �sound �exhausted. �I �know �that �I �was �when �I �hadto �deal �with �that �problem. �You �want �to �find �resolution �and �you �areworking �really �hard �forit! We�ve �parsed �it �like �this: Utterance �One: �You �sound �exhausted. �(Reflection, �could �be �simpleorcomplex) Utterance �Two: �I �know �that �I �was �when �I �had �to �deal �with �that �problem. �(Self-..disclosure, � not �coded) UtteranceThree: �Youwantto �findresolution �and �youare �workingreally �hard �forit! �(Affirm) E.3. When to Parse. �Clientstatementssuch �as ��yeah�or ��right�thatdo �notinterruptthe �interviewersequenceareconsideredfacilitativestatements,and �shouldnot �interruptthe �interviewer �volley �when �coding. �However,thevolleymightbeparsedif �the �client�sfacilitative �statement �servesas �an �answertothe �clinician�sdirectquestionor �reflection.Remember,the defaultis �to �choosefewer �parses. Forexample,iftheclinician �says: LetmeseeifI�vegotthisstraight. �You�re �not �happy �about �being �here �today �but �you �are willing �toconsidermakingafewchanges. �You �realize �your �drinking �has �been �causing �you �someproblemsandyouthinkitmightbetimetomakeachange. If �the �client �responds ��yeah� �throughout �the �previous �utterance �as �a �way �ofconveyingacknowledgmentof �the �therapist, �the �utterance �should �not �be �parsed �by �the �client�s �interruption. �Comparethattothisclinicianexample: Youarereallyworriedaboutyourdrinkingandreadytomakesomechanges. �Doyouthinkit�stimetotalkabouttreatment? Here, �if �the �client �responds �with ��Yeah�inagreementthatitistimefortreatment,theclient statementwouldinterrupttheutteranceandanewvolleywouldbeginwiththeclinician�snext utterance. � Whenattemptingto�keepup�withfastmovingclinician/clientinteractions �that �contain �multipleinstancesoffacilitativespeech,thecodersisadvisedtorememberthedecisionruletoparsefewer,ratherthanmore,utterances. E.4.Behavior �Codes E.4.a. �Giving �Information Thiscategoryisusedwhentheinterviewergivesinformation,educates,providesfeedback,or expresses �a �professional �opinion �withoutpersuading, �advising, �or �warning. �Typically, �the �tone �of �theinformationisneutral, �and �the �language �used �to �convey �generalinformationdoesnotimply that �itisspecificallyrelevanttotheclientorthattheclientmustactonit. �Nosubcodes �are �assigned �forGivingInformation. � Forexample: From �myprofessionalexperience,Ithinkthatgoingtocardiacrehabisthebestchoice �for �mostpeopleinyoursituation. Theguidelinesstatethatwomenshouldnotdrinkmorethansevendrinksperweek. E.4.a.1. �Structuring statements are �not coded as Giving Information.Theseincludestatementsthat indicate �what �is �going �to �happen �during �the �session, �instructions �for �an �exercise �during �the �session,set-..upofanotherappointment, �or �discussion �about �thenumberandtimingofsessions foraresearch �protocol. Examplesofstructuringstatements: I �would �like �for �you �to �take �a �look �at �this �list �of �strengths �and �picktwoor �three �that �apply to �you. Nowperhapswe�lltakealookatyourtreatmentplanandseewhatneedschanging. Weonlyhavetwomoresessionsafterthisonesoweshouldplanforthat. E.4.a.2. �Differentiating Giving Information from other Behavior counts. Givinginformationshouldnotbeconfusedwithpersuading, �confronting, �or �persuading �with �permission. From �myprofessionalexperience,Ithinkthatgoingtocardiacrehabisthebestchoicefor �you. �(Persuade) From �myprofessionalexperience,Ithinkthatgoingtocardiacrehabwouldbethebest thing �for �you. �What �do �you �think �about �this �as �an �option? �(Persuadewithpermission; �Seek) Youindicatedduringtheassessmentthatyoutypicallydrinkabout18 �standard �drinks �per �week. �This �far �exceeds �social �drinking. �(Confront) Well, �you �are �only �eating �two �fruits �per �day �according �to �this �chart, �even �though �you �said you �are �eating �five. �It �can �be �easy �to �deceive �yourself. �(Confront) It �workedforme,anditwillworkforyouifyougiveitatry. �WeneedtofindtherightAA �meetingforyou. �You �just �didn�t �find �a �good �one. �(Persuade) Iwouldrecommendthatyoualwayswearabikehelmet. �It �will �really �protect �you �inthe event �of �a �crash. �(Persuade) Todaywe�regoingtotalkaboutsomethingsthathaveworkedforothers. �(Not �coded� structuringstatement) Thechoiceisyours,butinmyopinion,stayingintreatmentwouldbeagood �thing �for �you.(EmphasizeAutonomy;PersuadewithPermission) Continuingtodrinkattheselevelscanreallyharm �yourliver.(Persuade) E.4.b. �Persuade Theclinicianmakesovertattemptstochangetheclient�sopinions,attitudes,orbehaviorusingtoolssuchaslogic,compellingarguments,self-..disclosure, �orfacts �(and �the �explicitlinking �of �thesetoolswithanovertmessagetochange). Persuasionisalso �coded �if �the �clinician �gives biasedinformation,advice,suggestions,tips,opinions,orsolutionstoproblemswithout an �explicitstatementorstrongcontextualcueemphasizingtheclient�sautonomyinreceivingthe recommendation. Notethatifthetherapistisgivinginformationinaneutralmanner,withoutanexplicitfocusoninfluencingorconvincingtheclient,theGivingInformationcodeshouldbeused. DecisionRule: �If �the �codercannotdecide �betweenthe �Persuasionand �theGivingInformation code,theGivingInformationcodeshouldbeused. Thisdecisionruleisintendedtoseta relatively �high �bar �forthe �Persuasioncode. Youcan�tgetfivefruitsandvegetablesinyourdieteverydayunlessyouputsomefruitin your �breakfast.(Persuade) IusedtobeoverweightbutIdecidedtotakemylifeintomyownhands.Youwouldbebetteroffifyoudidthesamething.(Persuade) You �just �don�t �know �how �good �your �life �can �be �if �you �quit �drinking �altogether. �(Persuade) Well, �your �own �father �was �a �heavy �drinker �so �it�s �very �likely �you �are �too. �(Persuade) � Well,weknowthatsonsofalcoholicscarryanincreasedriskofproblem �drinking.(GivingInformation) Ihavesomeinformationaboutyourriskofproblem �drinkingandIwonder �if �I �can �share �it with �you.(Seek) Allofthesethingsaddedtogethertellmethatyouwillhavealotoftroublemanagingyourbloodsugarlevelswithoutsomemedicationtohelp.Iwouldn�ttellyouthisunlessIreally thought �it �was �the �best �thing �for �you. �My �job �is �to �help �you �feel �better, �and �I �take �thatveryseriously. �(Persuade) Ifyouuseacondom �everytimeyouhavesex,thenyouneverhavetoworryaboutwhetheryoumighthavecontractedasexuallytransmittedinfection.Wouldn�tthatbe great? �(Persuade) Weusedtothinkthathavingkidsindaycarewasnotgoodforthem,butnowtheevidenceindicatesthatitactuallyhelpsthem �havebettersocialskillsthankidswhoneverattend. (GivingInformation) With �everything �going �on �in �your �life �right �now, �how �could �it �hurt �to �have �your �kidsin �daycare �acouple �ofdays �aweek?(Persuade) E.4.c. �Persuade �with Permission PersuadewithPermissionisassignedwhentheinterviewerincludesanemphasisoncollaborationorautonomysupportwhilepersuading. Theconditionofpermissionmaybe present �when � 1. The �client �asks �directly �for �the �clinician�s �opinion �on �what �to �do �or �how �to �proceed. 2. Theclinicianaskstheclientdirectlyforpermissiontoprovideadvice,makesuggestions,giveopinion,offerfeedback,expressconcerns,makingrecommendations,ordiscussaparticulartopic. 3. Theclinicianusesautonomysupportivelanguage �to �preface �or �qualify �the �advice �such �thattheclientmaychosetodiscount,ignore,orpersonallyevaluatethatadvice. Thecliniciancouldseekageneralsenseofpermission(Howaboutwestarttodaytalkingaboutyourprobationrequirements?)orpermissionspecifictoatopic,condition,oractionitem �(Ifitis alrightwithyou,I�llsharesomestrategiesthathavebeenusedbyotherstokeeptheirblood sugar �incheck.). � Permissionmaybeobtainedbefore,duringorafterpersuasionisused,butmust �occur �close �to �persuasionintime.IfPersuadewithPermissionisaccompaniedbyanexplicitSeekingCollaborationorEmphasizingAutonomy,boththePersuadewithPermissionandtheSeekingCollaborationor/EmphasizingAutonomycodeshouldbeassigned. Ifaclinicianhasaskedformoregeneralpermission,itdoesnotneedtoberepeatedforeverystatementorsuggestion. Thereisa�conditionofpermission�thatmaylastforseveralminutes. Iftheclinicianchangesthetopic,becomesmoredirective, �starts �adding �significant �content �(becomestheexpert),orstartsprescribingaplanwithoutagainaskingpermission,itispossiblethat �the �clinician �would �then �receive �a �Persuade �code. � � � Notethatiftheinterviewerisprovidinginformationoradviceinaneutralmanner,theGivingInformationcodeshouldbeusedinstead. Ifthe �coderis �uncertain, �the �GI �code �should �be �preferred. Well,yourfatherwasaproblem �drinkersoyoudefinitelyhaveanincreasedrisk accordingtothenumbers. Buteveryone �isunique. Whatare �your �ownthoughts �about that? (PersuadewithPermission;Seek) Forsomeofmyclients,daycarecanturnouttobeareallifesaverespeciallywhenlifegetsasdemandingasyoursisrightnow. ButIknowyou�vementionedyourconcerns �about that,somaybeitisnotforyounomatterwhat. (PersuadewithPermission;Seek) Ihavesomeideasaboutgettingyourkidstohelpmore. Igotmyownchildtocleanhis room �byusingastarchart. Hegotastarforeverydayhecleanedhisroom �andafterhe earnedsevenstars,hegottochoosethemovieforSaturdaynight. (Persuade) Moving to Insulin YourA1Clevelhasbeenover12thelast3timeswe�vecheckedit. Ingeneral,thisputs peopleatriskforcomplications(GivingInformation) LookingatyourA1Clevel,itisapparentthatyou�vebeenhavingsometroublecontrolling your �blood �sugar �levels, �despite �your �best �efforts. � �My �best �advice �at �this �point �is �for �you �is �toswitchtoinjectableinsulinandgiveuptheoralmedication. �ButIdon�tknowif �thatis �somethingyouarewillingtoconsider. I�dwelcomeyourthoughts. (Persuadewith Permission;Seek) Clinician:I�vereviewedyourlabresultsandIwonderifImightsharesomethoughts abouthowyoucanimproveyour �control �of �your �blood �sugar �levels. �(Seek) Client:Sure,I�mcuriouswhatyouthink. Clinician:LookingatyourA1Clevel,itisapparentthatyou�vebeenhavingsometrouble controlling �your �blood �sugar �levels, �despite �your �best �efforts. � �My �best �advice �at �this �pointisforyouistoswitchtoinjectableinsulinandgiveuptheoralmedication. ButIdon�t knowifthatissomethingyouarewillingtoconsider. I�dwelcomeyourthoughts. (PersuadewithPermission;Seek) Parenting Self Disclosure Clinician:Well,Ihaveastoryaboutmyownchildthatmightfitinhere. Iwonderifyou�d beinterestedinhearingaboutmyexperiences. (Seek) Client:Anythingthatwouldhelp. Clinician:Igotmyownchildtocleanhisroom �byusingastarchart. � �He �gota �star �for �everydayhecleanedhisroom �andafterheearnedsevenstars,hegottochoosethemovie forSaturdaynight. (PersuadewithPermission) Smoking Cessation Clinician: IwonderifitwouldbeokifIprovidesomeinformationwith �you �about �waysto quitsmoking?(Seek) Client:Yes. Clinician:I�vehadgoodluckwithclientsusingthenicotinegum. (Persuadewith Permission) E.4.c.1 Decision Rule �for Persuade �and Persuade �with Permission DecisionRule: WhenbothPersuadeANDPersuadewithPermissionoccurinthesameutterance,thecodershouldonlyassignthePersuadewithPermissioncode. Thismayresultinuncoded Persuasionstatementsintheexchanges. � �To �the �extent �that �the �coder �judges �that �these �uncoded persuasionstatementsimpingeonthecollaborationbetweenthepair,thisshouldbecapturedonthe �Partnership �global �rating. E.4.d. �Questions Allquestionsfrom �clinicians(open,closed,evocative,fact-..finding, �etc.) �receivethe �Questioncode but �only �one �question �per �volley �is �coded. � � �Thus, �if �a �clinician �asked �four �separate �questions �in �a �single �volley, �only �onequestion �would �be �tallied. �Closedand �open �questionsare �not �differentiated �in �the �MITI �4.0. �Instead, �coders �attend �to �the �nature �ofthe �clinician�squestions �withtheglobalratingsinmind. �Forexample,many �fact-..finding �questions �within �an �interview might resultinalower �ratingonthe �Partnership �global �and �reduce �opportunities �to �SidestepSustain �Talk. � E.4.e.Reflections Thiscategoryismeanttocapturereflectivelisteningstatementsmadebytheclinicianin response �to clientstatements. �Reflectionsmayintroducenewmeaningormaterial,buttheyessentiallycaptureandreturntoclientssomething �about �what �they �have �just �said. �Reflections �maybeeitherSimpleorComplex. � E.4.e.1. Simple �Reflection Simplereflectionstypicallyconveyunderstandingorfacilitateclient�clinician �exchanges. �These �reflectionsaddlittleornomeaning(oremphasis)towhatclientshavesaid. �Simplereflectionsmaymarkveryimportantorintenseclientemotions,butdonotgofarbeyondtheclient�s originalstatement. �Cliniciansummariesofseveralclientstatementsmaybecodedassimple reflections �if �thecliniciandoesnotusethesummarytoaddanadditionalpointordirection. � E.4.e.2.Complex Reflection Complexreflectionstypicallyaddsubstantialmeaningoremphasistowhattheclienthassaid. �These �reflections �serve �the �purpose �of �conveying �a �deeperormorecomplexpictureofwhatthe client �has �said. �Sometimestheclinicianmaychoosetoemphasizeaparticularpartofwhattheclienthassaidtomakeapointortaketheconversationinadifferentdirection. �Cliniciansmay add �subtle �or �very �obviouscontenttotheclient�swords,ortheymaycombinestatementsfrom �theclienttoform �summariesthataredirectional �in �nature. � Speeding Tickets Client:Thisisherthirdspeedingticketinthreemonths. �Our �insurance �is �going �togothrough �the �roof. �I �could �just �kill �her. �Can�tsheseeweneedthatmoneyforotherthings? Interviewer:You�refurious �aboutthis. �(Simple �Reflection) or Interviewer:Thisisthe �laststrawfor �you. �(Complex �Reflection) Controlling Blood Sugar Interviewer:Whathaveyoualreadybeentoldaboutmanagingyourbloodsugarlevels? (Question) Client:Areyoukidding? �I�vehadtheclasses,I�vehadthevideos,I�vehadthehomenurse visits. �I �have �all �kindsof �advice �about �how �to �get �better �at �this, �but �I �just �don�t �do �it. �I �don�t �know �why. �MaybeIjusthaveadeathwishorsomething,youknow? Interviewer:Youare �pretty �discouraged �aboutthis. �(Simple �Reflection) or Interviewer:Youdon�tknowwhy � �you�re �sabotaging �yourself. �(Complex �Reflection) Mother�s Independence Client:Mymotherisdrivingmecrazy. �Shesaysshewantstoremainindependent,butshecallsmefourtimesadaywithtrivialquestions. �ThenshegetsmadwhenIgiveheradvice. Interviewer:Thingsareverystressfulwithyourmother.(Simple �Reflection) or Interviewer:You�rehavingahardtimefiguringoutwhatyourmotherreallywants. �(Complex �Reflection) or Interviewer:Areyouhavingahardtimefiguringoutwhatyourmotherreallywants? �(Question) or Interviewer:Whatdoyouthinkyourmotherreally �wants? �(Question) Smoking Client: I�msotiredofbeingtoldwhattodo. �Nooneunderstands �howdifficultthis �isfor �me. Interviewer:Is �thisoverwhelming �you? �(Question) or Interviewer:You �are �angry �and �frustrated. �(ComplexReflection) or Interviewer:It�s �hard �for �people �around �you �to �get �it.(ComplexReflection) DECISION RULE:When �acoder �cannotdistinguish �between �asimpleandcomplexreflection (including �forsummaries), �thedefaultistocodeaSimpleReflection.. � E.4.e.3. �Series of Reflections When �a �clinician �offers �a �series �ofsimpleandcomplexreflectionsin the �same �volley,only �one �ComplexReflectionshould �be �coded. �Reflections �often �occur �in �sequence,and �over-..parsing �can �leadto �difficulties �in �obtaining �reliabilityor �takeawayfrom �theintentofthevolley. �Therefore, �if �a �clinician �offersaSimpleReflection, �followed �by �anEmphasizing �Autonomystatement,andthen aComplexReflection, �only �the �codes �ofComplexReflectionandEmphasizewouldbe �given. � Diet Failure Client:Ikeepfailing �inthis �diet. �I �do �okayforawhile,butthenIfindmyselfeatinganentirepanofbrownies,andruiningallmyprogress. �Doyouknowhowmanycalories there �are �in �a �pan �of �brownies? �Nevermindtheicecream �Ieatwiththem. �Inever �realized �it �would �be �so �hard. Clinician:It�stwo �steps �forward �and �then �onestepback. �Thatkind �ofprogress �justdoesn�t seem �enough. �Andwhat�shardisthatsomethingthatissonormalforyou,likeapanof brownies, �is �so �terrible �for �your �weight. �Ifyouknewthiswouldbesohard,youmightnot have �even �tried �to �lose �weight.(ComplexReflection) Client:No,Ihave �to �dothis. �Even �if �I �have �to �accept �that �I �will �never �eat �another �brownie �therestofmydamnlife,Istillhavetostopkillingmyselfwithmyweight. Clinician: Youwanttoloseweightsomuchthatyouwouldevengiveupbrowniesif �youreally �had �to. �(ComplexReflection,addedvalue �forCultivatingChange �Talk) or Clinician:Actually,youdon�thavetogiveupanyfoodforever. �Research �shows �that �when �youtrytorestrictyourselffrom �foodsyoulove,youwilljusteatmoreofthem.Thebest goal �istoeatthem �inmoderation. �(Persuade) E.4.e.4. Reflection and Question in Sequence Sometimestheinterviewerbeginswith �a �reflection, �but �adds �a �question �to ��check� �the �reliability �of �the �reflection. �Bothelementsshouldbecoded. Client: �I �just �can�t �keep �using �like �this. � Clinician:You�re �certain �you �don�t �ever �want �to �use �heroin �again. �Is �that �right? �(Complex Reflection, �Question) Client:MybosssaidI�monprobationnow.Noovertime,nobonuses.Nothing. Clinician:Yourbosssaidyoucan�tworkovertimeanymore �because �ofthis �incident. �What � doyoumakeofthat?(SimpleReflection, �Question) E.4.e.5 Structuring Statements posing as reflections Sometimestheinterviewerwillaskaquestion,butwillprecedethequestionwithinformationdesignedto �cue �the �listener �aboutthe �contextfor �it. �Essentially �this �functions �as �a �way �of �saying; �Rememberthat �other �thing �you �said? �Well, �now �I �want �to �ask �you �this �about �it�. �These �types �of �structuringstatementsthatoccurpriortoquestionsshouldnot be �codedas �separate �reflections. �Insteadtheyshouldbeconsideredstructuringstatementstoprovidecontext �for �a �question �and therefore �not �coded. � �The �intent �ofthis �rule �is �to �avoid �giving �credit �for �reflections �when �the �interviewerismerelycueingtheclientaboutthetopic. Iftheinterviewermakesacleardistinctionorstopbetweenthe�setup�statementandthe question,aseparatereflectionmaybecoded. �Forthis �to �be �the �case,the �clientshould �have �an opportunitytorespondinsomewaybeforethequestionoccurs. Interviewer:Youwere �describing �thatyouhaven�treturned �to �thatstore �where �you �stole � the �candy. �Doyoufeelyouare �avoidingit?(Question) or Interviewer:Youhaven�treturned �to �the �store �whereyoustolethecandy.(Simple Reflection) Client:Right. Interviewer:Doyoufeelyouare �avoiding �it?(Question) When �the �coderdeterminesthatthepurposeofthereflectionistoprovideafoundationoracue foraquestion, �it �should �not �be �coded. E.4.f. � �MI-.Adherent �(MIA) �Behaviors It �is �importanttonotethatoftenexamplesofgoodMIpracticewillnotearnanMIA �code. �One commonmistakefornovicecoders(andexpertpractitionersofMI)istospotexampleofgoodMIpracticethattheytryto�fit�intooneoftheMIA �codes. �TakecaretoassignonlytheMIA �codes thatareavailablehere,andonlywhentheexample�ringsthebell�asaclearexampleofthecode. � Whenindoubt,orwhenyouareworkingtoohardtomaketheexamplefit, �select �another �code �instead. �Rememberthatadjustingaglobalratingcanhelpcompensateforelementsofexcellent MI �practicethat �are �not �easily �capturedwitha �behavior �count. �**UnlikepreviousversionsoftheMITI,eachsubtypeofMIAdherent(MIA)behaviorisnowcoded �and �tallied �separately. � E.4.f.1 What happens when a statement might fit more �than one �MIA Category? �Trump� (origin 1580�s) verb: to surpass or beat noun: playing card of a suit that ranks above �the �others Mostofthetime,coders �willbe �able �to �assignaMIA �code �with �certainty. �Sometimes,though, coders �will �encounter �single �utterances �that �could �fit �intomorethanoneMIA �category. �Aswith all �other �MITI �codes, �uncertainty �aboutMIA �is �resolved �by �usinga �decisionrules. �These �are �sometimescalledtrumpingrules, �because �they �tell �therater �which �codes �shouldprevailwhen �the �decision �isunclear. � ThefollowinghierarchyshouldbeusedtodeterminewhichcodeshouldbeassignedforMIA �(seeFigure �1). �If �the �coderisunsure �whichcodeismoreappropriate, �the �lower �code �should �be �used �(i.e., �it �should �be �the �default). �Forexample, �if �thecoder �is �uncertain �whether �to �assignEmphasize Autonomy �orSeek, �theSeekcode �should �be �used. �Lower �codesonthepyramidaregivenwhen the �coder is uncertain.To �assign �the �highest �code �onthepyramid,thecodershouldhavea reasonable �degree �ofconfidencethatthecodeisatrueexampleofthatcategory. �When �there �is less �certainty, �the �coder �defaults �to �the �lower �codes. Theintentofthistrumpingpyramidisto �protect� �codes �havinghighimportanceinmotivationalinterviewingfrom �beingassignedtoo easily. Affirmations,forexample,arerelatively�inexpensive�fortheinterviewer,whereasemphasizingautonomyisbothmorechallengingtoachieveandhasgreatertheoreticalinterest. � �ThereforethebarisintentionallysethigherfortheEmphasizeAutonomycode. E.4.f.1.a. �What if the �coder is not sure �whether the �code �should be �a MIA or some �other code �(such as �a Question or a Reflection)? When �in �doubt, �the �coder �shouldnot codeMIA.Thus,ifastatementcould �becodedasMIA �or �someothercode,MIA �shouldbeassignedonlyiffalls �clearly �within �that �category. �When �uncertain, �the �coder �selects �the �other �code. � E.4.f.2. Affirm (AF) Anaffirmation(AF)isaclinicianutterancethataccentuatessomethingpositiveabouttheclient. �To �be �considered �an �Affirm,theutterancemustbeaboutclient�sstrengths,efforts,intentions,or worth.Theutterancemustbe �giveninagenuinemannerandreflectsomethinggenuineabout �the �client. �It �does �not �have �to �be �focused �on �the �change �goal �andcould �reflect �a ��prizing� �ofthe �clientforaspecifictrait,behavior,accomplishment,skill,orstrength. �Affirmsareoftencomplex reflections, �and �when �this �occurs, �the �Affirm �code �should �be �preferred. � Affirmshouldnotbecodedautomaticallyforthe �clinician�sagreeing �with, �approval �of, �cheerleading �for, �or �non-..specific �praising �ofthe �client. �Theymustbeexplicitly �linkedto �client �behaviors �or �specific �characteristics. � �Theutterancemustseem �genuineandnotmerely facilitative. **NotethatthisdefinitionofAffirm �ismorestringentthanthatboth �what �isusedin � Motivational Interviewing (Miller �&Rollnick, �2013) �andin �previous �versions �of �the �MITI. � Specifically,statementsofsupport(�It�salways �hard �when �you �are �getting �started�) �are nolonger �coded �in �the �MITI. 26 IfthecoderisnotcertainwhetherthestatementisspecificorstrongenoughtomerittheAffirm �code,it should not be �assigned.9.9 You came up with a lot of great ideas on how to reduce your drinking. Great jobbrainstormingtoday. �(Affirm) It�simportanttoyoutobeagoodparent,justlikeyourfolkswereforyou.(Affirm) Iam �reallyproudofyou.(Notcoded;notspecific). You �have been �able to avoid sweets throughout �the holiday �and you�re proud of your accomplishment. �It �haspaid �off! �(Affirm;trumpsReflection) You �are the kind of person �who takes her responsibilities �seriously, �wanting �to �do �the �rightthing. �(Affirm) Withtheparkingproblemsandtheraincomingdown,ithasn�tbeeneasytogethere. I appreciatethatyoucontinuetocome.(Affirm) �Iknowit�sreallyhardtostopsmoking.(Support; �not �coded) � �You �did �great! �(Notcoded) Wayto �go! �(Notcoded) You�ve been �working �so hard at �being �a �good parent. �I�m �so impressed with your willingnessto �stay �in �there �even �when �the �going �gets �tough! �(Affirm) Given what you have told me about your previous success with losing weight, I am �confident �that �you �will �be �successful �again �when �you �are �ready. �(Affirm) You�re �feeling �pretty �discouraged �about �the �fast �foods. �You �had �hopedto �not �hit �the �drive thru �at �all �this �past �two �weeks. �Itstrikesmethoughthat, �even �if �you �went �for �fast �food twiceduringthattime,thatisconsiderably �lessthanwhen �you �were �going �every �day. �Thatseemslikeabigchange!(Affirm) E.4.f.2.a. Three �strikes rule �for Affirmations Clinicians �canoveruse �affirmationsby �repeating �them �manytimesduringtheconversation.Ingeneral,thefirsttwoorthreetimes,thestatementmaybecredibleandcodedasanAffirmifthe �coderis �confident �that �the �utterance �still �clearly �falls �into �the �Affirmcategory.Afterthat,theyare typically �not �coded. E.4.f.3 Seeking Collaboration This �code �is �assigned �when �a �clinician �explicitlyattemptstosharepoweroracknowledgethe expertise �of �the �client. � �It �can �occur �when �the �cliniciangenuinely �seeks �consensus �with �the �client regardingtasks,goals �ordirections �ofthe �session. �Seeking �collaboration �maybeassignedwhen the �clinician �askswhattheclientthinksaboutinformationprovided.Whenpermissiontogiveinformationoradviceissought,SeekingCollaboration �is �typically �assigned. When �a �clinician �asks �about �the �client�s �knowledge �or �understanding �of �a �particular �topic, �this �is coded �as �a �Question. � �It �is �not �considered �to �be �Seeking �Collaboration. Ihavesomeinformationabouthowtoreduceyour �riskof �coloncancer �and �Iwonder �ifI mightdiscuss �itwith �you. �(Seeking �Collaboration) �What �have �you �already �been �told �about �drinking �during �pregnancy? �(Question) Woulditbealrightifwespendsomediscussingthestandardsforconsumingalcohol during �pregnancy �(Seeking �Collaboration) �Thismaynotbetherightthingforyou,butsomeofmyclientshavehadgoodlucksetting thealarm �ontheirwristwatchtohelpthem �remembertochecktheirbloodsugarstwo hours �after �lunch. �(Seeking �Collaboration,considerPersuadewithPermission) �HowcanI �help �you �with �this? �(Seeking �Collaboration) Would �it �beall �rightifwespentsometimetalkingaboutsmoking?Iknowyoudidn�tcome here �to �talk �about �that. �(Seeking �Collaboration) I �have �your �assessment �results. �Areyouinterested �in �going �over �those? �(SeekingCollaboration) E.4.f.3.aNote: �Elicit�Provide�Elicit �(E�P�E) �exchangesmayor may �not bean �exampleof seeking �collaboration. �Eachitem �istypicallycodedseparately. Elicit-.Provide-.Elicit without Seeking Collaboration Clinician: �What �do �you �already �know �about �drinking �during �pregnancy (Question)? Client: �Iknowit�sbetter �ifIdon�tdrink. Clinician: �Yes. �It�srecommendedthatwomenabstainfrom �alcoholduringpregnancy. �(GI) Elicit-.Provide-.Elicit with Seek Collaboration Clinician: �What �do �you �already �know �about �drinking �during �pregnancy (Question)? Client: �Iknowit�sbetter �ifIdon�tdrink. Clinician: �Whatdoyoumakeofthisinformation?Howdoesitfitin �with �your �approach �to � drinking? �(Seeking �Collaboration) In �contrast �to: Clinician:Whatdo �youalready �knowaboutpossible �waysofquittingsmoking?(Question) Client:Iknowthatthepatchissupposedtobethemosteffective �for �quitting. �Howlong �can �I �be �on �the �patch? �Is �it �only �supposed �to �be �used �for �a �week �ortwo? Clinician:Thepatchisonewaytoquitsmoking.Itisaneffectivemethodandistypicallyusedforaboutfourtosixmonths(GI). E.4.f.4. Emphasizing Autonomy �(Emphasize) These �are �utterances �that �clearly �focus �the �responsibility �with �the �client �fordecisionsaboutand �actions �pertaining �to �change. �They �highlight �clients�senseofcontrol,freedom �ofchoice,personal autonomy,orabilityorobligationtodecideabouttheir �attitudes �and �actions. �These �are �not statementsthatspecificallyemphasizetheclient�ssense �ofself-..efficacy, �confidence, �or �ability �to �perform �aspecificaction. Yes, �you�re �right. �Noonecan �force �you �stop �drinking. �(EmphasizingAutonomy) � You�rethe �one �who �knows �yourself �best �here. �What �do �you �think �ought �to �be �on �this �treatmentplan?(EmphasizingAutonomy) � Thenumberoffruitsandvegetablesyouchoosetoeatisreallyuptoyou.(EmphasizingAutonomy) � This �is �really �your �life �and �your �path.You �are �the �only �one �who �can �decide �which �direction �you �will �go. �Where �do �you �think �you �would �like �to �gofrom �herewithyourexercise? �(EmphasizingAutonomy) You �are �in �a �tough �spot. �Being �in �jail �leaves �you �feeling �like �you �haveno �control �over �your life. �Andyouarebeingaskedtoconsiderengaginginatreatmentprogram �thatmightgive yousomecontrolbackifyoudecidetodothat. �You �are �not �sure �what �to �choose �at �this �point. �(EmphasizingAutonomy) This �is �both �an �opportunity �and �a �challenge �as �you �see �it. �You �are �weighing �the �options and �figuring �out �what �will �work �best �for �you. �(EmphasizingAutonomy) Quit drinking Client:I�mprettysureIcanquitdrinkingforgood. Clinician:Youfeelconfidentyoucan �quitdrinking �because �youhave �doneitbefore. � (Reflection; �AddedvalueforCultivatingChange �Talk) Clinician:There�s �achoice �infrontof �youand �youfeelpretty �sure �which �way �youwantto �go �(EmphasizingAutonomy) Clinician:Youfeelpretty �sure �aboutwhich �way �youwantto �go(Reflection; �Addedvalue forCultivatingChange �Talk) Clinician:You�reready �to �stop(Reflection; �Addedvaluefor �CultivatingChange �Talk) Checking Blood Sugar Levels Client: I�mnotreadytocheckmybloodsugareveryday,butIcoulddoitonceaweekor so. Clinician: �In �the �end, �it�s �really �up to �you how often �you �check �your �blood �sugar. (EmphasizingAutonomy) Clinician:One �change �you�reconsidering �ischecking �weekly.(SimpleReflection;Added value �forCultivatingChange �Talk) Clinician: �It�s �really �hard �to �get that test in �every �day �(Complex Reflection; �Decreased � value �forSoftening �Sustain �Talk) HIV test Client: LastweekItalkedtotheAdviceNurseaboutahometest. �ShesaidIcouldbuyone �at �the �drugstoreand �get �the �results �back �right �away. Clinician: You have already taken some steps to find the answer you need. (Reflection; � Addedvaluefor �Cultivating �Change �Talk) Clinician: Now you have to make the decision about what �is the best �choice for you. (EmphasizingAutonomy) Clinician: �You �feel �two �ways �about �finding �out �(ComplexReflection) Clinician:Ihavesomeinformationaboutthehometestingkits. �IwonderifI �couldshareit � with �you. �(Seeking �Collaboration) Clinician:Yahoo! �Youmadeittoyourgoal!(Affirm) Clinician: You�ve �got �whatit �takes. �(Affirm) E.4.g. �MI �Non-.Adherent �(MINA) �Behaviors ThereareonlytwoMINA �codes:PersuadeandConfront. E.4.g �1. Persuade �(see �Section E.4.b.) E.4.g.2. � �Confront. � Thiscodeisusedwhentheclinicianconfrontstheclientbydirectlyandunambiguouslydisagreeing,arguing,correcting,shaming,blaming,criticizing,labeling,warning, �moralizing, ridiculing,or �questioningthe �client�shonesty.Such �interactions �willhave �the �quality �of �uneven �powersharing,accompaniedbydisapprovalornegativity.Includedhereareinstanceswheretheinterviewer �uses �a �question �or �even �a �reflection, �but �the �voice �tone �clearly �indicates �a confrontation. � Restatingnegativeinformation �already �known �or �disclosed �by �the �client �can �be �either �aConfront or �a �Reflection. �Most �Confronts �can �be �correctly �categorized �by �careful �attention �to �voice �tone �and �context. DecisionRule:Intherelativelyunusualcircumstancewherethecoderisnotcertainwhethertocode �an �utterance �as �a �Confrontation �or �Reflection, �no code �should be �assigned. YouweretakingAntabusebutyoudrankanyway?(Confront) You �think �that �isany �way �to �treat �people �you �love? �(Confront) Yes,youareanalcoholic.Youmightnotthinkso,butyouare.(Confront) Waitaminute.ItsaysrightherethatyourA1Cis12.I�msorry,butthereisnowayyou could �have �been �controlling �your �carbohydrates �like �you �said �if �it�s �that �high. �(Confront) Think �of �your �kids, �for �crying �out �loud. �(Confront) You �haveno �concerns �whatsoever �about �your �drinking? �(Confront;Question �code �not �assigned �since �Confront �trumpsQuestion) Mostpeoplewhodrinkasmuchasyoudocannoteverdrinknormallyagain.(Confront) IhaveaconcernaboutyourplantodrinkmoderatelyandIwonderifIcanshareitwith you. �(Seeking �Collaboration) Discipliningyourchildwithpunishmentisaslipperyslope.Itseemsalrightinthe �beginning �but �then �one �thing �leadsto �another. �(Confront) Rememberyousaidthatyourcholesterollevelwasathreattoyourlife.Ifyoucan�tget your �diet �under �control, �you �are �risking �a �stroke �or �a �heart �attack. �(Confront) Well, �kids �who �are �not �supervised �closely �by �their �parents �are �athigher �riskfor �substance �abuse. �I �wonder �what �you �think �about �your �own �parenting �skills �in �that �regard. �(Probably �Confront�listen �for �tone) If �you �choose �to �continue �to �drink, �there�s �nothing �we �can �do �to �helpyou. �(Probably �Confront�listen �for �tone). � Whencliniciansuseconfrontationtoemphasizeaclientstrength,virtueorpositiveachievement,theAffirm �codeshouldbeconsidered. AConfrontisnotmandatorywhentheclinicianisclearly attemptingtoaffirm �orsupporttheclient. Terrible �Mother Client: I�materriblemother. Clinician:Noyouare �not.Youarehavingsometroubles,butyouarestillagreatmother. (Affirm) Cholesterol Improvement Client: Iimprovedthismonth.Iateatleastthreeservingsoffruitsorvegetablesevery single �day. Clinician:Yes, �butyour �cholesterollevelis �stillway �too �high.(Confront) or Clinician: You�vemadesomerealprogressinyoureatinghabits.Whatdoyoumakeof �that intermsofyourlonger-..term �healthgoals?(Affirm;Seeking �Collaboration) E.4.g.3. Decision rules for MINA Persuasionandconfrontationsometimesoverlapandcanfitinmorethanonecategory. �When �this �happens, �the �following �hierarchy �should �be �used �(see �Figure �2): Figure 2: �Decision �rules �for �MINA �codes F. �STATEMENTS �THAT �ARE �NOT �CODED �IN �THE �MITI The �MITI �is �not �an �exhaustive �coding �system �becausesomeutterancesmaynotreceivea behavior �code. � ExamplesofutterancesthatarenotcodedintheMITI. Structurestatements: �Nowwe�lltalkabouttheformsfrom �lastweek.� Greetings: �HiJoe.Thanksforcomingintoday.� Facilitativestatements: �Okay, �all �right.Good.� Previous �session �content: �Lastweekyoumentionedyouwerereally tired.� Incompletethoughts: �Youmentioned�.�(clientinterrupts) Off-..topicmaterial: �It�s �a �bit �cold �in �here.� G. �CHOOSING �THE �LENGTH AND �TYPE �OF �THE �CODED �SEGMENT ThedevelopmentoftheMITIwasdoneusing20-..minutesegmentsofpsychotherapy �tapes. �It �maybepossibletousetheMITIforlongeraudiosegments(e.g., �the �entire �session). �We �only cautionthatourattempttoincreasethelengthofthecodingsegmentwas �associatedwith(1) �problemswithsustainedcoderattention,(2)difficultyformingglobaljudgmentswithincreaseddata, �and �(3)logisticaldifficultiesinobtaininguninterruptedworktimeinabusysetting. � Similarly,mostofourinitialdatahavebeen �gathered �usingaudio �recordingsrather �thanvideo. �TheMITIcanbeusedtocodevideo,butshouldnotbealteredtogathervisualinformation. � H. SUMMARY �SCORES BecausecriticalindicesofMIfunctioningareimperfectlycapturedbyfrequencycounts, �we �have �foundthatmanyapplicationsofcodingarebetterservedwithsummaryscorescomputedfrom �code �frequencies,ratherthantheindividualscoresthemselves. �Forexample,theratioofreflectionstoquestionsprovidesaconcisemeasureofanimportant �MI �process. �Below �isa �partiallistofsummaryscoresthatserveasoutcomemeasuresfordeterminingcompetenceinMI,aswellasformulasforcalculatingthem. � TechnicalGlobal �(Technical) =(CultivatingChange �Talk+ �Softening �Sustain �Talk)/2 � Relational �Global �(Relational) =(Partnership+Empathy)/2 � (% �CR) � =CR/(SR �+ �CR) � Reflection-..to-..Question �Ratio �(R:Q) =Totalreflections/(Total �Questions) � TotalMI-..Adherent =SeekingCollaboration+Affirm �+EmphasizingAutonomy � Total �MI �Non-..Adherent =Confront+ �Persuade Notethattheseformulaswillyieldsummaryscoresthatarenotcomparabletopreviousversionsof �the �MITI. I. �CLINICIAN �BASIC �COMPETENCE AND �PROFICIENCYTHRESHOLDS Below �aresuggested �MITI �basiccompetenceandproficiency �thresholds �for �clinicians. �Please �note �that �these �are �basedupon �expert opinion,andcurrentlylacknormativeorothervalidity datato �supportthem. �Until �those �databecomeavailable, �these �thresholds �should �be �used �in �conjunction �with �other �datatoarriveatanassessmentofclinicianbasiccompetenceand proficiency �in �using �MI. Fair  Good � Relational  3.5  4 Technical  3  4 %CR  40%  50% R:Q  1:1  2:1 Total �MIA  . . Total �MINA  . . List �of �MITI Codes GLOBALRATINGS CultivatingChange �Talk Softening �Sustain �Talk �Partnership � �Empathy  (Cultivate) (Sidestep) (Partner) (Empathy) BEHAVIORCOUNTS GivingInformation Persuade PersuadewithPermission Question SimpleReflection ComplexReflection Affirm Seeking �Collaboration EmphasizingAutonomy Confront  (GI)(Persuasion) (Persuasion �with) (Q) (SR)(CR)(AF) (Seek) (Emphasize) (Confront) Appendix A: Questions �about Whether the MITI is �Appropriate for Your Intervention Motivational �interviewing �can �often �be �usedto �address �broader �life �changesand �situations �that �donotinvolve �aspecific �change �goal, �buttheMITIwillbeoflimitedvalueforinterventionsof this �type. �Formoreabstractchanges, �it �is �difficult �for �coders �to �reliably �evaluate �clientlanguage �about �change �and�moreimportantly�whether �the �interviewer �is �appropriately �evoking �and respondingto �it. � WithoutthiscriticalevokingelementofMI,theMITIisanimpoverishedtoolforevaluatinga �clinician�s �ability �to �deliver �MI. �Lowscoresmightalsobeearnedinanumberofimportantareas, even �though �the �clinician �appropriately �chooses �not �to �influence �client �language �in �any �particular direction. �Similarly,whentheinterviewfocusesentirelyontheengaging �or �focusing �processes, �the �MITI �will �reflect �lower �scoresbecausetheevokingelementofMIisabsent. �TheMITIismost appropriate �when �the �full �range �of �MI �skillsis �intended �in �an �interview. TheMITIisoflimitedvalueinthefollowingsituations: -Change �goalcannotbespecifiedasabehavior(forexample,makingadecision) -Cliniciandoes �notwish �to �influence �the �clienttoward �any �particular �goal(equipoise) -Clinicianintentionally �uses �only �engaging �or �focusing �skills J.1What if there is more than one change goal? Itissometimesthecasethatinterventionshavemorethanonetargetchange �(e.g.,(1) �medicationcomplianceand(2) �findingappropriate �housing). �Aslongasbothtargetchanges resultinbehaviorsfrom �theclient �(rather �than �internal �events) �the �MITI �can �be �used. � J.2. Examples of Inappropriate Target Goals for MITI coding J.2.a. �Making a Decision�: �Target change without obvious change talk Ifthetargetgoalis�makingadecision,� �the �content �of �thechange �talk �willnot �be �asideofthe �dilemma(aswhenadesirablechangeisspecified),butinstead �language �about �the �decision �itself. �Forexample,whenthechangegoalissmokingcessation,thefollowingstatementswouldbechange �talk: �I �needto �quitsmoking� �IfIdon�tquit,I�mgoingtogetcancer� �I�dhavesomuchmoremoney� �Iwanttobeagoodexampleformychildren� If �the �targetgoalis ��making a decision aboutsmoking,� �none �ofthosestatementswouldbe change �talk. �Instead, �thefollowingstatementswouldbe: �Ineedtomakeadecision� �IfIdon�tmakeadecision,I�lljustkeepgoingasIam� �Settling �this �would �be �such �a �relief� �I �hate �being �so �wishy-..washy� Althoughitistheoreticallypossibletocodechangetalkformakingadecision,itisacomplextaskthathasnotbeenevaluatedpsychometricallyandwehaveelectednottoincludeitintheMITI4.0. J.2.b. �Becoming a Better Person�: �Target Change That Is Not a Behavior If �the �target �change �is �a �non-..behavioral �goal, �defining �change �talk �will �be �difficult. �Forexample, wouldthefollowingstatementsqualifyaschangetalkiftheperson�sgoalis�tobecomeabetter person�? �Ineedtoexpressmyangermorefreely� �IfIwantmorefriendsIneedthinkaboutthewishesofothersinsteadofmyself� �Iwanttoexercisemoreoftenandeatless� �I �can �do �that �now �without �feeling �any �guilt �at �all!� �Iam �goingtogetmychakrasintobetteralignment� Eachoftheseexamplesdependsentirelyontheclinicalcontext(andthemindoftheinterviewer)todeterminewhethertheyarechangetalkorsomethingelse. �Forexample,a �goal �to �exercise moreoftenandeatlessmightbeagoodfitforapersonwho �has �just �been �told �that �their �BMI �is over25inaprimarycaresetting,butnot �for �a �client �with �anorexia. �Oritmightbethatnoneof thesestatementsfitintobeingabetterperson. �The �point �is �that �coders �cannot �reliably �discern �the �change �talk �in �such �situations,and �interrater �reliability �cannot �be �achieved. �Forthis �reason, �the �MITI �4.0 �(as �with �previous �versions) �specifies �a �target �behavior �that �is �known �in �advance. J.3. What if I only �want to �evaluate the engaging and focusing dimensions within an interview? Evenwheninterviewsarenotintendedtoevokeargumentsforchange,someofthesubscalesoftheMITImightstillbeusefulinevaluatingthebasiccounselingskillsoftheinterviewer. �The �PartnershipandEmpathyglobalratings�as �well �as �the �behavior �counts �for �Questions, �Reflections,MIAdherentandMINon-..Adherent�willallyieldusefulinformationaboutnondirective �approaches �to �interviewing. �Theymaybeusedandadaptedwithappropriate citation. Appendix B: Frequently Asked Questions 1. What if my session is �less �than 20 minutes �long? � Global �ratingsmaybemoredifficulttomeasureinsessionslessthan10minuteslong. For extremelyshortsessions(2-..5minutes),itmaybebestto �code �only �the �behavior �counts. � � 2) How is �MI Spirit captured in the MITI 4.0? MISpiritisnolongermeasuredintheMITI4.0. ImportantdimensionsofMISpirit,suchas �partnership �and �evoking �a �client�s �reasons �to �change,arestillmeasuredintheMITI4.0 3) �What happened to the percentage of MIA and MINA summary scores? ThepercentageofMIA �andMINA �behaviorswere �calculated �inprevious �versions �of �the �MITI: (PercentageofMIA �=MIA/(MIA �+MINA)andPercentageofMINA �=MINA/(MIA �+MINA).Thesepercentageswerenotparticularlyinformative,especiallyforsessionsthathadnoMIA �orMINA �behaviors. � �. � �ThepercentageofMIA �andMINA �behaviorswasmisleadinganduninformativeand was �therefore �droppedfrom �theMITI �4.0. � 4) What are the threshold scores �for the MITI 4.0? DeterminingthresholdsfortheMITI4.0isnotasstraightforwardasinpreviousversions. In somewaysthisisbecauseourunderstandingofthepracticeofMIismorecomplexthaninyearspast,sodecidingwhatis�acceptable�canbeachallenge. Further,almostalltheratingshavebeenalteredinthenewversionmeaningtheycannotbecomparedwithpreviousversions.Finally,welackempiricaldatatomakesomerecommendationsonmanyratings,thoughwehopethatwillbecomingbeforelong. A few things to note: FortheMITI4.0,therecommendedratingsfortheRelationalElement �are �higher �than �forthe �TechnicalElementatboththeFairandGoodpracticelevel. Thisreflectsthecurrenttheoretical frameworkinMIemphasizingtheengaging,relationalskillsasafoundationfortheevoking,technicalelements. We �have �concludedthatthereisenoughempiricalevidencetoretainthethresholdscoresforcomplexreflectionsand,inparticular,theratioofquestionsandreflectionssotheyhavebeenretained. MIA �andMINA �recommendationshaveintentionallybeenleftunspecifiedsincewehavenodata yettoinform �them. WeencouragefullreportingofallMITI4.0scoresinclinicaltrialsinwhichitisusedtodocumenttreatmentfidelity. When �tiedto �clinicaloutcomes,this �would �allow �for confidentrecommendationsofMIA �andMINA �inarelativelyshorttime. 5) What if I should technically assign the Persuade with Permission code, but the permission doesn�t seem genuine or the information seems �to be more of a Persuade? Theglobalmeasures,particularlyPartnership,maybeimpactedbyhowthecliniciangivesinformation,obtainspermission,orprovidessuggestionsoropinions. Thefollowingare situationsthatmightwarrantaloweringofthePartnershipglobal, �even �when �the �Persuade �with Permissionbehaviorcountisgiven. 1. Theclinicianasksforpermissionforvirtuallyeverycomment 2. Thetoneofthepermissionaskingisperfunctoryorinsincere 3. Thecliniciandoesnotgivetimefortheclienttorespondtothepermissionaskingbeforeprovidingtheinformation 4. Theclinicianoverstretchestheboundariesofthepermission(i.e.askingtoprovideinformationondrinkingandthengivesthatandadditionalinformationonotherlifestyle or �behavioralissues) 5. Theclinicianasksforandreceivespermissionforageneraltopicandthenproceedsto�dump�toomuchinformation(maygoonforseveralminutes) 6) When sustain talk does �not occur in a session how should the Softening �Sustain Talk Scale be scored? Wecannottellwhysustaintalkdoesnotoccurinasession. ItmightbeabsentbecausetheclientgenuinelydidnothaveanytoofferORitmightbeabsentbecausetheclinicianwasskilledenough �not �to �elicit �it. � � �Coders �are �not �asked �to �guess �about �this. � HigherratingsonSSTmaybegiveneveninthecompleteabsenceofsustaintalk. Essentially,the clinician �gets �the ��benefit �of �the �doubt� �when �sustain �talk �does �not �appear, �which �can �resultin �occasional �dubiously �high �ratings �on �SST. � �This �is �anelementofuncertaintyintheSSTcodethat is �acceptable. �SST �ratings �should �be �lowered �when �sustain �talk �is �infrequent, �but �the �clinician �responds �inappropriately �whenitdoes �occur. 7) What happens �when the clinician responds �to sustain talk by reflecting �it or giving �it attention in order to convey empathy or build partnership? For example, the first 12 responses �on the Rounder tape appear to be acknowledging �sustain talk, which then increases. How can this �clinician get a LOW score on SST? It �isfrequentlythecasethatthereisatradeoffbetweentherelationalandtechnicalelementsofMI. Atherapistwhoattemptstosoftensustaintalkwithoutbuildingcollaborationisoftenunsuccessful.TheRoundersessionshowsseveralexcellentexamplesof �SST �later �in �the �session, �once �partnership �has �been �established. � �It �is �the �session as a whole �that is reflected in the �global ratings,and the �coder should consider the �pattern and momentum of the �client�s language �in assigning rating. 8) How should SST be scored in a decisional balance exercise? In �a �true �decisional �balance �both �sides �of �the �change �equation �are �explored �equally. � �There �isnot �an �effort �to �soften �sustain �talk, �but �ratherto �draw �it �out �fully. � �When �this �is �the �case, �low �SST ratings �shouldbeassignedassumingtheyarenot�salvaged�laterintheinterview. 9) Can the Seeking �Collaboration code be assigned for simply asking �the client what they think about information that has �been provided, for example in feedback about an assessment �or �in �the �E-.P-.E �format? TheSeekcodecanbeassignedanytimethecoderfeelstheclinicianismakingagenuineefforttocollaborate �and �share �power �with �client. � �The �Seek �code �should �be �withheld �if �the �coder �does �not perceivesuchaneffort,forexampleifaclinicianappearstobesimplytestingaclient�s understandingwithoutexplicitlyattemptingtosharepower. Rhetorical,roteorsuperficialquestionstoaclient(�whatdoyouthinkofthat?�)maynotnecessarilyreceivetheSeekcode.Raters �areaskedtodefertheSeekcodeiftheycannotdecidewhetheritismerited. Recording #:____________________ Coder:_____________________ Date: ____/____/____ Global Ratings Technical Components Cultivating Change Talk  1  2  3  4  5 Softening Sustain Talk  1  2  3  4  5 Relational Components Partnership  1  2  3  4  5 Empathy  1  2  3  4  5 Target Change:_______________________ Behavior Counts Total Giving Information (GI) Persuade (Persuade) Persuade with Permission (Persuade with) Question (Q) Simple Reflection (SR) Complex Reflection (CR) Affirm (AF) Seeking Collaboration (Seek) Emphasizing Autonomy (Emphasize) Confront (Confront) Start time and sentence:__________________________________________________________________________ End time and sentence:________________________________________________________________";

        string openAIUrl = "https://api.openai.com/v1/chat/completions";
        string openAIAuthorization = Environment.GetEnvironmentVariable("OPENAI_AUTHORIZATION");

        var requestData = new RequestData
        {
            model = GetVariable("LLM_MODEL"),
            max_tokens = 512,
            temperature = 1
        };

        var generateSessionSummaryPrompt = 
        "**Summary of Session**\n" +
        "You are a motivational interviewing (MI) expert tasked with summarizing the session based on the data collected. Provide a concise summary of the session, highlighting key points, insights, and recommendations for future sessions to help the counselor/trainee improve their MI skills. Use the MITI 4.2.1 Coding Manual to help understand what all the codes mean. You do not have to reference the scores below in your summary, but just provide a general overview of the session based off of them and the conversation history.\n\n" +
        "The summary should be direct and too the point, without any sections or bullet points. The summary should be a paragraph or two long. Keep it under 512 tokens.\n\n" +
        "Below are MI scores for evaluating the effectiveness of the counselor/trainee conducting MI and reasoning behind the scores:\n" +
        $"- **Cultivating Change Talk Score:** {GetVariable("CULTIVATING_CHANGE_TALK_SCORE")}\n" +
        $"- **Softening Sustain Talk Score:** {GetVariable("SOFTENING_SUSTAIN_TALK_SCORE")}\n" +
        $"- **Partnership Score:** {GetVariable("PARTNERSHIP_SCORE")}\n" +
        $"- **Empathy Score:** {GetVariable("EMPATHY_SCORE")}\n\n" +
        "**Reasoning:**\n" +
        $"- **Cultivating Change Talk Reasoning:** {GetVariable("CULTIVATING_CHANGE_TALK_REASONING")}\n" +
        $"- **Softening Sustain Talk Reasoning:** {GetVariable("SOFTENING_SUSTAIN_TALK_REASONING")}\n" +
        $"- **Partnership Reasoning:** {GetVariable("PARTNERSHIP_REASONING")}\n" +
        $"- **Empathy Reasoning:** {GetVariable("EMPATHY_REASONING")}\n\n" +
        "**Behavior Code Counts:**\n" +
        $"- **CR Count:** {GetVariable("CR_COUNT")}\n" +
        $"- **SR Count:** {GetVariable("SR_COUNT")}\n" +
        $"- **Q Count:** {GetVariable("Q_COUNT")}\n" +
        $"- **GI Count:** {GetVariable("GI_COUNT")}\n" +
        $"- **Persuade Count:** {GetVariable("PERSUADE_COUNT")}\n" +
        $"- **Persuade with Count:** {GetVariable("PERSUADE_WITH_COUNT")}\n" +
        $"- **AF Count:** {GetVariable("AF_COUNT")}\n" +
        $"- **Seek Count:** {GetVariable("SEEK_COUNT")}\n" +
        $"- **Emphasize Count:** {GetVariable("EMPHASIZE_COUNT")}\n" +
        $"- **Confront Count:** {GetVariable("CONFRONT_COUNT")}\n\n" +
        "**Behavior Code Percentages:**\n" +
        $"- **Percent CR:** {GetVariable("PERCENT_CR")}%\n" +
        $"- **Reflect Question Ratio:** {GetVariable("REFLECT_QUESTION_RATIO")}%\n" +
        $"- **Total MI Adherent:** {GetVariable("TOTAL_MI_ADHERENT")}\n" +
        $"- **Total MI Non-Adherent:** {GetVariable("TOTAL_MI_NON_ADHERENT")}\n\n" +
        $"**Technical Global Score:** {GetVariable("TECHNICAL_GLOBAL")}\n" +
        $"**Relational Global Score:** {GetVariable("RELATIONAL_GLOBAL")}\n\n" +
        "**Counseling Transcript with Reasoning for MITI Behavior Encoding & Persona Characteristics (User = Participant/Clinician; SimPatient = SimPatient/Client):**\n" +
        $"{GetVariable("SESSION_HISTORY_FOR_SUMMARY")}\n\n" +
        "**MITI 4.2.1 Coding Manual:**\n" +
        $"{mitiManual}\n\n" +
        "Output:\n" +
        "<Insert your summary here>";

        requestData.messages.Add(new ChatMessage { role = "user", content = generateSessionSummaryPrompt.ToString() });

        var bodyJsonString = JsonConvert.SerializeObject(requestData);

        using UnityWebRequest client = new UnityWebRequest(openAIUrl, "POST")
        {
            uploadHandler = new UploadHandlerRaw(Encoding.UTF8.GetBytes(bodyJsonString)),
            downloadHandler = new DownloadHandlerBuffer()
        };

        client.SetRequestHeader("Content-Type", "application/json");
        client.SetRequestHeader("Authorization", "Bearer " + openAIAuthorization);
        yield return client.SendWebRequest();

        if (client.result != UnityWebRequest.Result.Success) {
            Debug.Log(openAIUrl + ": " + client.error);
            callback.DynamicInvoke(new JsString(""), new[] {new JsString("")});
        } else {
            var responseContent = client.downloadHandler.text;
            SessionSummaryResponse jsonResponse = JsonConvert.DeserializeObject<SessionSummaryResponse>(responseContent);

            string messageContent = jsonResponse.choices[0].message.content.Replace("\n", "").Replace("\t", "").Replace("\r", "").Replace("'", "").Replace("\"", "").Replace(",", "").Replace("’", "").Replace("‘", "").Replace("“", "").Replace("”", "").Replace(",", "");

            string query = $"INSERT INTO eval_summary (user_id, session_id, summary, gi_count, persuade_count, persuade_with_count, q_count, sr_count, cr_count, af_count, seek_count, emphasize_count, confront_count, empathy_score, partnership_score, cultivating_change_talk_score, softening_sustain_talk_score, technical_global_score, relational_global_score, mi_adherence_percentage, mi_non_adherence_percentage, empathy_score_reasoning, partnership_score_reasoning, cultivating_change_talk_score_reasoning, softening_sustain_talk_score_reasoning) VALUES ({GetAsInt("USER_ID")}, {GetAsInt("SESSION_ID")}, '{messageContent}', {GetAsInt("GI_COUNT")}, {GetAsInt("PERSUADE_COUNT")}, {GetAsInt("PERSUADE_WITH_COUNT")}, {GetAsInt("Q_COUNT")}, {GetAsInt("SR_COUNT")}, {GetAsInt("CR_COUNT")}, {GetAsInt("AF_COUNT")}, {GetAsInt("SEEK_COUNT")}, {GetAsInt("EMPHASIZE_COUNT")}, {GetAsInt("CONFRONT_COUNT")}, {GetAsDouble("EMPATHY_SCORE")}, {GetAsDouble("PARTNERSHIP_SCORE")}, {GetAsDouble("CULTIVATING_CHANGE_TALK_SCORE")}, {GetAsDouble("SOFTENING_SUSTAIN_TALK_SCORE")}, {GetAsDouble("TECHNICAL_GLOBAL")}, {GetAsDouble("RELATIONAL_GLOBAL")}, {GetAsDouble("TOTAL_MI_ADHERENT")}, {GetAsDouble("TOTAL_MI_NON_ADHERENT")}, '{GetVariable("EMPATHY_REASONING")}', '{GetVariable("PARTNERSHIP_REASONING")}', '{GetVariable("CULTIVATING_CHANGE_TALK_REASONING")}', '{GetVariable("SOFTENING_SUSTAIN_TALK_REASONING")}');";

            Debug.Log("Eval Summary Query: " + query);

            LitebodyDatabase db = (LitebodyDatabase)Globals.Get<Database>();
            Globals.Get<LitebodyDatabaseSessionManager>().InsertOrUpdate(query);

            if (client == null)
            {
                Debug.LogError("Client is null! Cannot invoke callback.");
                // Handle this error appropriately - maybe yield break;
            } 
            else if (client.downloadHandler == null)
            {
                Debug.LogError("Client.downloadHandler is null! Cannot invoke callback.");
                // Handle this error - maybe yield break;
            }
            else if (string.IsNullOrEmpty(client.downloadHandler.text)) 
            {
                Debug.LogError("Client.downloadHandler.text is null or empty! Cannot invoke callback.");
                // Handle this error - maybe yield break;
            }
            else 
            {
                // **Now it's safe to invoke:**
                callback.DynamicInvoke(new JsString(client.downloadHandler.text),
                                    new[] { new JsString(client.downloadHandler.text) });
            }
        }
    }

    private static void SetVariable(string name, object value)
    {
        Globals.Get<PropertyTable>().Set(name, value.ToString());
    }

    private static string GetVariable(string name)
    {
        return Globals.Get<PropertyTable>().Get(name).Replace(",", "");
    }

    private static int GetAsInt(string input)
    {
        return float.TryParse(GetVariable(input), out float result) ? (int) result : 0;
    }

    private static double GetAsDouble(string input)
    {
        return float.TryParse(GetVariable(input), out float result) ? (double) result : 0;
    }
}